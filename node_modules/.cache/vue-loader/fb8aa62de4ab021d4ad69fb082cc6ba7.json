{"remainingRequest":"C:\\xampp\\htdocs\\IHM\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\xampp\\htdocs\\IHM\\src\\components\\Sncf.vue?vue&type=style&index=0&id=418a94da&scoped=true&lang=css","dependencies":[{"path":"C:\\xampp\\htdocs\\IHM\\src\\components\\Sncf.vue","mtime":1641486030534},{"path":"C:\\xampp\\htdocs\\IHM\\node_modules\\css-loader\\dist\\cjs.js","mtime":1639666687974},{"path":"C:\\xampp\\htdocs\\IHM\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1639666689290},{"path":"C:\\xampp\\htdocs\\IHM\\node_modules\\postcss-loader\\src\\index.js","mtime":1639666688613},{"path":"C:\\xampp\\htdocs\\IHM\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1639666687566},{"path":"C:\\xampp\\htdocs\\IHM\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1639666688819}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpoMyB7DQogIG1hcmdpbjogNDBweCAwIDA7DQp9DQp1bCB7DQogIGxpc3Qtc3R5bGUtdHlwZTogbm9uZTsNCiAgcGFkZGluZzogMDsNCn0NCmxpIHsNCiAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICBtYXJnaW46IDAgMTBweDsNCn0NCmEgew0KICBjb2xvcjogIzQyYjk4MzsNCn0NCi5tYXAgew0KICBoZWlnaHQ6IDcwMHB4Ow0KfQ0K"},{"version":3,"sources":["C:\\xampp\\htdocs\\IHM\\src\\components\\Sncf.vue"],"names":[],"mappings":";AAkQA,CAAC,EAAE;EACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;AAClB;AACA,CAAC,EAAE;EACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACrB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;AACZ;AACA,CAAC,EAAE;EACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACrB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;AAChB;AACA,EAAE;EACA,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAChB;AACA,CAAC,CAAC,CAAC,EAAE;EACH,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;AACf","file":"C:/xampp/htdocs/IHM/src/components/Sncf.vue","sourceRoot":"","sourcesContent":["<template>\r\n  <div class=\"row\">\r\n    <div class=\"row mt-4\">\r\n      <div class=\"col-sm-6 m-auto\">\r\n        <figure class=\"text-center\">\r\n          <blockquote class=\"blockquote\">\r\n            <p class=\"mb-0\">\r\n              Du temps libre entre deux trains et rien de prévu ?\r\n            </p>\r\n            <p>\r\n              Voici de quoi vous occuper ! Notre application vous liste les\r\n              lieux notables selon votre destination dans un périmètre que vous\r\n              choississez.\r\n            </p>\r\n          </blockquote>\r\n        </figure>\r\n      </div>\r\n      <hr class=\"mt-2\" />\r\n    </div>\r\n  </div>\r\n  <div class=\"row\">\r\n    <div class=\"col-sm-4\">\r\n      <h1>Que visiter ?</h1>\r\n      <form ref=\"form\" @submit.prevent>\r\n        <div class=\"form-group\">\r\n          <label class=\"form-label mt-4\"\r\n            >Dans quelle gare êtes/serez vous ?</label\r\n          >\r\n          <input\r\n            list=\"gare\"\r\n            class=\"form-control\"\r\n            placeholder=\"Nom de votre gare\"\r\n            onfocus=\"this.value=''\"\r\n            v-model=\"nom_gare\"\r\n          />\r\n          <datalist id=\"gare\">\r\n            <option :key=\"index\" v-for=\"(gares, index) in gare\">\r\n              {{ index + \".\" + gares.fields.alias_libelle_noncontraint }}\r\n            </option>\r\n          </datalist>\r\n        </div>\r\n        <label for=\"customRange3\" class=\"form-label\"\r\n          >Jusqu'ou pouvons nous aller ?</label\r\n        >\r\n        <input\r\n          type=\"range\"\r\n          class=\"form-range\"\r\n          min=\"0\"\r\n          max=\"20\"\r\n          step=\"1\"\r\n          id=\"customRange3\"\r\n          v-model=\"area\"\r\n        />\r\n        <small class=\"form-text text-muted p-0\"\r\n          >Vous avez définie une zone de {{ area }} km de rayon</small\r\n        >\r\n\r\n        <button type=\"submit\" class=\"btn btn-primary\" v-on:click=\"submit\">\r\n          Submit\r\n        </button>\r\n      </form>\r\n      <br>\r\n      <div class=\"row\" v-if=\"this.coordGare\">\r\n        <h6>{{ nom_gare.split(\".\")[1] }}</h6>\r\n        <ul>\r\n          <li>{{this.gare[nom_gare.split(\".\")[0]].fields.departement_libellemin}}</li>\r\n          <li>{{this.gare[nom_gare.split(\".\")[0]].fields.gare_regionsncf_libelle}}</li>\r\n          <li>{{this.gare[nom_gare.split(\".\")[0]].fields.adresse_cp }}</li>\r\n        </ul>\r\n\r\n\r\n      </div>\r\n    </div>\r\n    <div class=\"col-sm-8 map\">\r\n      <l-map class=\"map\" v-model=\"zoom\" v-model:zoom=\"zoom\" :center=\"center\">\r\n        <l-tile-layer\r\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n        ></l-tile-layer>\r\n        <l-control-layers />\r\n        <l-marker\r\n          v-for=\"(monument, index) in this.markers\"\r\n          :key=\"index\"\r\n          :lat-lng=\"[\r\n            monument.geometry.coordinates[1],\r\n            monument.geometry.coordinates[0],\r\n          ]\"\r\n        >\r\n          <l-popup>\r\n            <p class=\"font-weight-bold m-0\">\r\n              <a :href=\"monument.properties.Link\">{{\r\n                monument.properties.Nom\r\n              }}</a>\r\n            </p>\r\n            <p class=\"m-0 text-center\">{{ monument.properties.Distance }} km</p>\r\n          </l-popup>\r\n          ></l-marker\r\n        >\r\n        <l-marker v-if=\"this.coordGare\" :lat-lng=\"this.coordGare\">\r\n          <l-icon ref=\"icon\">\r\n            <img\r\n              :width=\"iconWidth\"\r\n              :height=\"iconHeight\"\r\n              style=\"margin-left: -15px\"\r\n              class=\"restaurant-icon\"\r\n              :src=\"iconUrl\"\r\n            />\r\n          </l-icon>\r\n          <l-popup>\r\n            {{ nom_gare.split(\".\")[1] }}\r\n          </l-popup>\r\n        </l-marker>\r\n      </l-map>\r\n    </div>\r\n  </div>\r\n  <div class=\"row\">\r\n    <div class=\"row\">\r\n      <hr class=\"mt-3\" />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport {\r\n  LMap,\r\n  LTileLayer,\r\n  LMarker,\r\n  LControlLayers,\r\n  LPopup,\r\n  LIcon,\r\n} from \"@vue-leaflet/vue-leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\n\r\nexport default {\r\n  name: \"Sncf\",\r\n  components: {\r\n    LMap,\r\n    LTileLayer,\r\n    LMarker,\r\n    LControlLayers,\r\n    LPopup,\r\n    LIcon,\r\n  },\r\n  props: {\r\n    marker: {\r\n      type: Object,\r\n      required: true,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      monuments: null,\r\n      gare: null,\r\n      center: [47, 2],\r\n      zoom: 6.15,\r\n      area: 10,\r\n      iconWidth: 30,\r\n      iconHeight: 30,\r\n      nom_gare: null,\r\n      index: null,\r\n      markers: [],\r\n      iconUrl: \"https://cdn-icons-png.flaticon.com/512/2088/2088138.png\",\r\n      coordGare: null,\r\n    };\r\n  },\r\n  mounted() {\r\n    axios\r\n      .get(\r\n        \"https://ressources.data.sncf.com/api/records/1.0/search/?dataset=referentiel-gares-voyageurs&q=&rows=2874&sort=-gare_alias_libelle_noncontraint&facet=departement_libellemin&facet=segmentdrg_libelle&facet=gare_agencegc_libelle&facet=gare_regionsncf_libelle&facet=gare_ug_libelle\"\r\n      )\r\n      .then((reponse) => {\r\n        this.gare = reponse.data[\"records\"].reverse();\r\n        console.log(this.gare[0].fields);\r\n      });\r\n    axios\r\n      .get(\r\n        \"https://www.data.gouv.fr/fr/datasets/r/48c28e1a-7d13-4b7e-97d0-7f778cf3a6e2\"\r\n      )\r\n      .then((response) => {\r\n        this.monuments = response.data.features;\r\n        // console.log(this.monuments[0].geometry.coordinates[1]);\r\n        //* index 0 et 1 pour les coordonnées\r\n      });\r\n    axios\r\n      .get(\r\n        \"https://diffuseur.datatourisme.gouv.fr/webservice/549d92de3c8a4686e521001a1bd57776/484d6ffd-567c-40a8-8e04-95969c03005f\"\r\n      )\r\n      .then((response) => {\r\n        this.newApiMonument = response.data.features;\r\n        console.log(this.newApiMonument);\r\n      });\r\n  },\r\n  computed: {\r\n    dynamicSize() {\r\n      return [this.iconSize, this.iconSize * 1.15];\r\n    },\r\n    dynamicAnchor() {\r\n      return [this.iconSize / 2, this.iconSize * 1.15];\r\n    },\r\n  },\r\n  methods: {\r\n    submit: function () {\r\n      console.log(this.nom_gare);\r\n      var index = this.nom_gare.split(\".\")[0];\r\n      this.center = [\r\n        this.gare[index].geometry.coordinates[1],\r\n        this.gare[index].geometry.coordinates[0],\r\n      ];\r\n      this.markers = [];\r\n      for (let i = 0; i < this.monuments.length; i++) {\r\n        var distance = this.getDistanceFromLatLonInKm(\r\n          this.center[0],\r\n          this.center[1],\r\n          this.monuments[i].geometry.coordinates[1],\r\n          this.monuments[i].geometry.coordinates[0]\r\n        );\r\n        if (distance <= this.area) {\r\n          distance = parseFloat(distance).toFixed(2);\r\n          if (\r\n            !(this.monuments[i].properties.Nom == \"Immeuble\") &&\r\n            !(this.monuments[i].properties.Nom == \"Maison\")\r\n          ) {\r\n            this.monuments[i].properties.Distance = distance;\r\n            this.monuments[i].properties.Link =\r\n              \"https://fr.wikipedia.org/wiki/\" +\r\n              this.monuments[i].properties.Nom.replace(\" \", \"_\");\r\n            this.markers.push(this.monuments[i]);\r\n          }\r\n        }\r\n        this.coordGare = this.center;\r\n        this.activate();\r\n      }\r\n    },\r\n    activate() {\r\n      setTimeout(() => (this.zoom = 11), 700);\r\n    },\r\n    deg2rad(deg) {\r\n      return deg * (Math.PI / 180);\r\n    },\r\n    getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2) {\r\n      var R = 6371; // Radius of the earth in km\r\n      var dLat = this.deg2rad(lat2 - lat1); // deg2rad below\r\n      var dLon = this.deg2rad(lon2 - lon1);\r\n      var a =\r\n        Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n        Math.cos(this.deg2rad(lat1)) *\r\n          Math.cos(this.deg2rad(lat2)) *\r\n          Math.sin(dLon / 2) *\r\n          Math.sin(dLon / 2);\r\n      var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n      var d = R * c; // Distance in km\r\n      return d;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nh3 {\r\n  margin: 40px 0 0;\r\n}\r\nul {\r\n  list-style-type: none;\r\n  padding: 0;\r\n}\r\nli {\r\n  display: inline-block;\r\n  margin: 0 10px;\r\n}\r\na {\r\n  color: #42b983;\r\n}\r\n.map {\r\n  height: 700px;\r\n}\r\n</style>"]}]}